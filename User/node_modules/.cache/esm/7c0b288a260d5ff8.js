let CustomErrorHandler,JWTService;_260‍.x([["default",()=>_260‍.o]]);_260‍.w("../services/customErrorHandler",[["default",["CustomErrorHandler"],function(v){CustomErrorHandler=v}]]);_260‍.w("../services/JwtService",[["default",["JWTService"],function(v){JWTService=v}]]);


const auth = async (req, res, next) => {
    let authHeader = req.headers;
    _260‍.g.console.log("Headers :", authHeader);
    if (!authHeader) {
        return next(CustomErrorHandler.unAuthorized());
    }
    const token = authHeader.authorization.split(" ")[1];
    _260‍.g.console.log("Token :", token);
    try {
        const { _id, role } = await JWTService.verify(token);
        req.user = {};
        req.user._id = _id;
        req.user.role = role;
        _260‍.g.console.log("request", req.user);
        next();
    } catch (err) {
        // console.log("error :", err);
        return next(CustomErrorHandler.unAuthorized("Unautorized !!"));
    }

};

_260‍.d(auth);